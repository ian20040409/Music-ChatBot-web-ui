/* ==============================
   防止縮放樣式
   ============================== */
* {
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
}

/* 允許輸入框選取文字 */
input, textarea {
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
}

html {
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
}

/* ==============================
   全局樣式（淺色模式）
   ============================== */
   body {
    font-family: 'Poppins','Noto Sans TC',sans-serif;
    background: linear-gradient(135deg,#e0c3fc,#8ec5fc);
    display:flex;justify-content:center;align-items:center;
    min-height:100vh;padding:1rem;
  }
  
  .chat-container-wrapper {
    width:100%;max-width:750px;
  }
  
  .card {
    border:none;border-radius:15px;
    box-shadow:0 10px 30px rgba(0,0,0,0.1);
    background-color:rgba(221,221,221,0.404);
    backdrop-filter:blur(100px);
    overflow:hidden;
  }
  
  .card-header {
    background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    color:#fff;padding:1.5rem;
    border-top-left-radius:15px;border-top-right-radius:15px;
  }
  
  .card-header h1 {
    font-weight:600;font-size:1.75rem;
  }
  
  .card-body { padding:2rem; }
  
  /* 問答類型選擇器 */
  .qa-type-selector {
    margin-bottom:1.5rem;padding:0.75rem;
    background-color:#f8f9fa;border-radius:10px;
  }
  .qa-type-selector .form-check-label { color:#495057; }
    /* 手機專用頂部 bar,桌機預設隱藏 */
  .mobile-top-bar {
    display: none !important;
  }

  /* 手機頂部動作按鈕：圓潤漸層 + 浮光陰影 */
  .mobile-top-bar .dropdown-toggle,
  .mobile-top-bar .mobile-style-btn {
    border-radius: 999px;
    border: none;
    padding: 0.65rem 1rem;
    font-weight: 600;
    letter-spacing: 0.01em;
    color: #fff;
    background: linear-gradient(135deg, #4b7bec, #8c54ff);
    box-shadow: 0 12px 30px rgba(76, 81, 191, 0.35);
    transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
  }
  .mobile-top-bar .dropdown-toggle::after {
    margin-left: 0.6rem;
    vertical-align: middle;
  }
  .mobile-top-bar .dropdown-toggle:hover,
  .mobile-top-bar .mobile-style-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 18px 35px rgba(76, 81, 191, 0.45);
    filter: brightness(1.05);
  }
  .mobile-top-bar .dropdown-toggle:focus,
  .mobile-top-bar .mobile-style-btn:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.35);
  }

  /* 下拉選單：玻璃擬態效果 */
  .mobile-top-bar .dropdown-menu {
    border: none;
    border-radius: 20px;
    padding: 0.4rem;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(18px);
    box-shadow: 0 25px 45px rgba(15, 18, 36, 0.18);
  }
  .mobile-top-bar .dropdown-item {
    border-radius: 14px;
    font-weight: 500;
    color: #2b2f3c;
    padding: 0.55rem 0.9rem;
    transition: background 0.2s ease, color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
  }
  .mobile-top-bar .dropdown-item:hover,
  .mobile-top-bar .dropdown-item:focus {
    background: linear-gradient(135deg, rgba(224, 195, 252, 0.35), rgba(142, 197, 252, 0.5));
    color: #1c1f2b;
    transform: translateX(2px);
    box-shadow: inset 0 0 0 1px rgba(148, 105, 255, 0.3);
  }
  .mobile-top-bar .dropdown-item.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    box-shadow: none;
  }
  .qa-type-selector .form-check-input:checked {
    background-color:#667eea;border-color:#667eea;
  }

  /* 桌機版回答風格按鈕 */
  .generation-params .btn-secondary {
    border:none;
    border-radius:999px;
    padding:0.65rem 1.6rem;
    font-weight:600;
    letter-spacing:0.01em;
    background:linear-gradient(135deg,#5562ff,#8a3fff);
    color:#fff;
    box-shadow:0 15px 32px rgba(85,98,255,0.35);
    transition:transform 0.2s ease,box-shadow 0.2s ease,filter 0.2s ease;
  }
  .generation-params .btn-secondary:hover {
    transform:translateY(-1px);
    filter:brightness(1.05);
    box-shadow:0 22px 40px rgba(85,98,255,0.45);
  }
  .generation-params .btn-secondary:focus-visible {
    outline:none;
    box-shadow:0 0 0 3px rgba(102,126,234,0.35);
  }

  /* 驗證按鈕 */
  #startVerifyBtn {
    border:none;
    border-radius:999px;
    padding:0.6rem 1.4rem;
    background:linear-gradient(135deg,#ffb347,#ff714a);
    color:#fff;
    font-weight:600;
    letter-spacing:0.01em;
    box-shadow:0 15px 35px rgba(255,113,74,0.35);
    cursor:pointer;
    transition:transform 0.2s ease,box-shadow 0.2s ease,filter 0.2s ease;
    display:inline-flex;
    align-items:center;
    gap:0.35rem;
    align-self:center;
    margin:0.5rem auto;
  }
  #startVerifyBtn::before {
    content:"";
    width:0.65rem;
    height:0.65rem;
    border-radius:50%;
    background:#fff;
    box-shadow:0 0 12px rgba(255,255,255,0.9);
  }
  #startVerifyBtn:hover {
    transform:translateY(-1px);
    filter:brightness(1.05);
    box-shadow:0 22px 42px rgba(255,113,74,0.45);
  }
  #startVerifyBtn:focus-visible {
    outline:none;
    box-shadow:0 0 0 3px rgba(255,147,79,0.35);
  }
  
  /* 輸入群組 */
  .input-group {
    border-radius:28px;
    overflow:hidden;
    border:1px solid rgba(255,255,255,0.65);
    background:rgba(255,255,255,0.98);
    box-shadow:0 18px 45px rgba(102,126,234,0.15);
    transition:box-shadow 0.3s ease,border-color 0.25s ease;
  }
  .input-group:focus-within {
    border-color:rgba(102,126,234,0.85);
    box-shadow:0 22px 55px rgba(102,126,234,0.25);
  }
  .input-group .form-control {
    border-radius:28px 0 0 28px;
    border:none;
    background:transparent;
    padding:0.9rem 1rem;font-size:1rem;
    transition:box-shadow .15s ease;
  }
  .input-group .form-control:focus {
    border-color:transparent;
    box-shadow:none;
  }
  
  .input-group .btn {
    border-radius:0 28px 28px 0;
    border:none;
    background-color:#667eea;
    padding:0.9rem 1.25rem;font-weight:500;
    transition:transform .15s ease,box-shadow .15s ease;
  }
  .input-group .btn:hover {
    background-color:#5a6fd0;border-color:#5a6fd0;
    box-shadow:0 6px 20px rgba(0,0,0,0.3);
    transform:translateY(-1px);
  }
  .input-group .btn:active {
    box-shadow:0 2px 8px rgba(0,0,0,0.3);
    transform:translateY(1px);
  }
  .input-group .btn:focus {
    outline:none;
    box-shadow:0 0 0 3px rgba(102,126,234,0.5);
  }
  .input-group .btn:disabled {
    background-color:#adb5bd;
  }

  /* 發送按鈕專屬樣式 */
  #sendButton {
    border:none;
    border-radius:0 28px 28px 0;
    background:linear-gradient(135deg,#4a90e2,#667eea);
    color:#fff;
    font-weight:600;
    letter-spacing:0.01em;
    box-shadow:0 12px 28px rgba(74,144,226,0.35);
    transition:transform 0.2s ease,box-shadow 0.2s ease,filter 0.2s ease;
  }
  #sendButton i {
    font-size:1rem;
  }
  #sendButton:hover:not(:disabled) {
    transform:translateY(-1px);
    filter:brightness(1.05);
    box-shadow:0 18px 38px rgba(74,144,226,0.45);
  }
  #sendButton:active:not(:disabled) {
    transform:translateY(1px);
    box-shadow:0 8px 18px rgba(74,144,226,0.35);
  }
  #sendButton:focus-visible {
    outline:none;
    box-shadow:0 0 0 3px rgba(102,126,234,0.4);
  }
  #sendButton:disabled {
    background:linear-gradient(135deg,#d1d1d1,#b0b0b0);
    box-shadow:none;
    cursor:not-allowed;
  }
  
  /* 建議提示詞 */
  .suggested-prompts {
    display:flex;flex-wrap:wrap;gap:.5rem;
  }
  .suggested-prompts button {
    position:relative;display:inline-block;
    padding:.4rem .8rem;font-size:.9rem;
    color:#343a40;background:#e9ecef;border:none;
    border-radius:20px;cursor:pointer;
    overflow:hidden;z-index:1;
    animation:fadeInUp .4s ease forwards;
    transition:transform .3s ease,box-shadow .3s ease,color .3s ease;
  }
  .suggested-prompts button::before {
    content:"";position:absolute;top:-2px;left:-2px;
    right:-2px;bottom:-2px;
    background:linear-gradient(45deg,#c3e1f6,#fbe8db,#d3c4f7);
    border-radius:22px;z-index:-1;
  }
  .suggested-prompts button:hover {
    transform:scale(1.08);
    box-shadow:0 6px 20px rgba(0,0,0,0.3);
    color:#0c0914;
  }
  
  /* 桌面版預設隱藏橫向滾動箭頭 */
  .scroll-indicator {
    display: none;
  }
  
  @keyframes fadeInUp {
    0% {opacity:0;transform:translateY(10px);}
   100% {opacity:1;transform:translateY(0);}
  }
  

  /* 半透明黑幕，还是交给 Bootstrap 原生 backdrop */
.modal-backdrop {
    background-color: rgba(0, 0, 0, 0.9) !important;
  }
  
  /* 当 Modal 打开时，<body> 会自动获得 .modal-open 类 */
  body.modal-open .chat-container-wrapper,
  body.modal-open footer {
    filter: blur(10px) brightness(0.7);
    transition: filter 0.3s ease-in-out;
  }
  
  
  
      
  
  


  /* 聊天區 */
  .chat-area {
    height:400px;overflow-y:auto;
    padding:1rem;margin-bottom:1rem;
    background:rgba(248,249,250,0.459);
    backdrop-filter:blur(8px);border-radius:10px;
  }
  .chat-area::-webkit-scrollbar {width:8px;}
  .chat-area::-webkit-scrollbar-track {background:#f1f1f1;border-radius:10px;}
  .chat-area::-webkit-scrollbar-thumb {background:#adb5bd;border-radius:10px;}
  .chat-area::-webkit-scrollbar-thumb:hover {background:#868e96;}
  
  .message-wrapper { margin-bottom:1rem;display:flex; }
  .message-wrapper.user { justify-content:flex-end; }
  .message-wrapper.bot { justify-content:flex-start; }
  
  .message {
    position:relative;
    padding:.8rem 1.2rem;
    border-radius:15px;
    max-width:80%;
    word-wrap:break-word;
    line-height:1.6;
    border:1px solid rgba(255,255,255,0.12);
    box-shadow:
      0 10px 25px rgba(17,20,56,0.18),
      0 2px 6px rgba(17,20,56,0.08);
    transition:transform .2s ease,box-shadow .2s ease;
  }
  .message:hover {
    transform:translateY(-2px);
    box-shadow:
      0 18px 35px rgba(17,20,56,0.25),
      0 4px 12px rgba(17,20,56,0.12);
  }
  .message.user-message {
    background:#667eea;color:#fff;
    border-radius:33px 25px 3px 33px; /* sharper bottom-right, softer elsewhere */
    border-color:rgba(255,255,255,0.35);
  }
  .message.bot-message {
    background:#fff;color:#343a40;
    border:1px solid rgba(102,102,102,0.18);
    border-radius:18px 25px 25px 3px; /* keep bottom-left (BL) subtle while rounding other corners */
  }
  .message.user-message strong { color:#f5f5f5; }
  .message.bot-message strong { color:#667eea; }
  
  .loading-message,.error-message {
    font-style:italic;color:#6c757d;padding:.5rem 0;
  }
  .error-message { color:#d9534f;font-weight:500; }
  
  .message-timestamp {
    font-size:.75rem;color:#adb5bd;margin-top:.3rem;display:block;
  }
  .user-message + .message-timestamp { text-align:right; }
  .bot-message + .message-timestamp { text-align:left; }

  /* 進階設定 Modal 按鈕樣式（淺色模式） */
  #paramsModal .btn {
    border-radius:999px;
    border:none;
    font-weight:600;
    padding:0.6rem 1.25rem;
    letter-spacing:0.01em;
    transition:transform 0.2s ease,box-shadow 0.2s ease,filter 0.2s ease;
  }
  #paramsModal .btn:focus-visible {
    outline:none;
    box-shadow:0 0 0 3px rgba(102,126,234,0.35);
  }

  #paramsModal .btn-outline-success,
  #paramsModal .btn-success {
    background:linear-gradient(135deg,#1dd1a1,#10ac84);
    color:#fff;
    box-shadow:0 15px 35px rgba(16,172,132,0.35);
  }
  #paramsModal .btn-outline-success:hover,
  #paramsModal .btn-success:hover {
    transform:translateY(-1px);
    filter:brightness(1.03);
    box-shadow:0 20px 40px rgba(16,172,132,0.45);
  }

  #paramsModal .btn-outline-primary {
    background:linear-gradient(135deg,#8d50ff,#5f8bff);
    color:#fff;
    box-shadow:0 15px 35px rgba(102,126,234,0.35);
  }
  #paramsModal .btn-outline-primary:hover {
    transform:translateY(-1px);
    filter:brightness(1.05);
    box-shadow:0 20px 42px rgba(102,126,234,0.45);
  }

  #paramsModal .btn-outline-warning {
    background:linear-gradient(135deg,#ff9a3c,#ff6f61);
    color:#fff;
    box-shadow:0 15px 35px rgba(255,140,0,0.35);
  }
  #paramsModal .btn-outline-warning:hover {
    transform:translateY(-1px);
    filter:brightness(1.05);
    box-shadow:0 20px 42px rgba(255,140,0,0.45);
  }

  #paramsModal .btn-outline-secondary {
    background:linear-gradient(135deg,#9ba4b5,#6b7382);
    color:#fff;
    box-shadow:0 15px 35px rgba(107,115,130,0.35);
  }
  #paramsModal .btn-outline-secondary:hover {
    transform:translateY(-1px);
    filter:brightness(1.04);
    box-shadow:0 20px 40px rgba(107,115,130,0.45);
  }

  /* 一鍵風格按鈕群組：保留扁平造型 */
  #paramsModal .btn-group.w-100 {
    gap:0.75rem;
  }
  #paramsModal .btn-group.w-100 .btn {
    border-radius:18px;
    padding:0.85rem 0.9rem;
    box-shadow:0 10px 24px rgba(0,0,0,0.15);
  }
  #paramsModal .btn-group.w-100 .btn small {
    display:block;
    margin-top:0.1rem;
    font-weight:500;
    opacity:0.85;
  }

  /* Modal 整體樣式 */
  #paramsModal .modal-dialog {
    display: flex;
    align-items: center;
    min-height: calc(100% - 1rem);
  }
  #paramsModal .modal-content {
    border-radius:15px;
    box-shadow:0 10px 30px rgba(0,0,0,0.2);
  }
  #paramsModal .modal-header {
    background:linear-gradient(135deg,#e3e7fa 0%,#e0c3fc 100%);
    border-top-left-radius:15px;
    border-top-right-radius:15px;
  }

  /* 滑桿樣式 - 淺色模式 */
  #paramsModal .form-range {
    background:transparent;
    height:8px;
  }
  #paramsModal .form-range::-webkit-slider-track {
    background:#e9ecef;
    border-radius:5px;
    height:8px;
  }
  #paramsModal .form-range::-webkit-slider-thumb {
    background:#667eea;
    border:2px solid #fff;
    border-radius:50%;
    height:20px;
    width:20px;
    cursor:pointer;
    -webkit-appearance:none;
    box-shadow:0 2px 6px rgba(0,0,0,0.2);
  }
  #paramsModal .form-range::-webkit-slider-thumb:hover {
    background:#5a6fd0;
    box-shadow:0 4px 12px rgba(102,126,234,0.3);
  }
  #paramsModal .form-range::-moz-range-track {
    background:#e9ecef;
    border-radius:5px;
    height:8px;
    border:none;
  }
  #paramsModal .form-range::-moz-range-thumb {
    background:#667eea;
    border:2px solid #fff;
    border-radius:50%;
    height:20px;
    width:20px;
    cursor:pointer;
    box-shadow:0 2px 6px rgba(0,0,0,0.2);
  }

  body::before {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  opacity: 0.3;
  background: radial-gradient(circle, #fdd8b1, #ffacc4, #d4a5f0, #a8d8f0);
  background-size: 300% 300%;
  animation: bgFlowLight 30s ease-in-out infinite;
  transition: all 0.6s ease;
}

body.thinking::before {
  opacity: 0.9;
  filter: blur(40px) brightness(1.3);
  animation: bgFlowLightThinking 3s ease-in-out infinite;
}

@keyframes bgFlowLight {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes bgFlowLightThinking {
  0% { background-position: 0% 0%; }
  25% { background-position: 50% 100%; }
  50% { background-position: 100% 50%; }
  75% { background-position: 50% 0%; }
  100% { background-position: 0% 0%; }
}


@media (max-width: 768px) {
  /* ===== 整體：預設佔滿螢幕，但允許需要時可捲動 ===== */
  html, body {
    min-height: 100%;
  }

  body {
    margin: 0 !important;
    padding-top: calc(env(safe-area-inset-top, 0px) + 1rem);
    padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 0.85rem);
    padding-left: calc(env(safe-area-inset-left, 0px) + 0.85rem);
    padding-right: calc(env(safe-area-inset-right, 0px) + 0.85rem);
    display: block !important;
    overflow-x: hidden;
    overflow-y: auto; /* 手機頁面可以向下捲動 */
    box-sizing: border-box;
  }

  /* 手機版隱藏整個標題列（header） */
  .card-header {
    display: none !important;
  }

  /* 隱藏 footer，避免多出捲動空間 */
  footer,
  .modal-backdrop + footer {
    display: none !important;
  }

  /* 最外層容器：佔滿整個畫面 */
  .chat-container-wrapper {
    width: 100% !important;
    min-height: calc(100dvh - (env(safe-area-inset-top, 0px) + 1rem) - (env(safe-area-inset-bottom, 0px) + 0.85rem));
    height: auto;
    max-height: none;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    overflow: visible;      /* 需要時讓整體內容往下延伸 */
  }

  /* Card 撐滿高度，自己也不捲動 */
  .card {
    flex: 1 1 auto;
    width: 100% !important;
    min-height: 100%;
    height: auto;
    border-radius: 0 !important;
    display: flex;
    flex-direction: column;
    overflow: visible;
    box-shadow: none !important;
    backdrop-filter: none !important;
  }

  /* 內容區：切成模式選擇 + 建議 + 聊天 + 輸入 */
  .card-body {
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
    min-height: 0;          /* 讓中間 chat-area 可以縮 */
    padding: 0.5rem;
    padding-top: 0.4rem;
    padding-bottom: calc(env(safe-area-inset-bottom, 0.5rem) + 0.5rem);
    overflow: hidden;       /* 不讓這層捲動，只交給 chat-area */
  }

  /* 問答類型選擇區：手機版改用下拉，所以隱藏原本 radio 列 */
  .qa-type-selector {
    display: none;
  }
  .generation-params {
    display: none; /* 隱藏原本中間那顆「回答風格」按鈕 */
  }

  /* 手機版頂部:模式下拉 + 回答風格按鈕 */
  .mobile-top-bar {
    display: flex !important;
    flex: 0 0 auto;
    margin-bottom: 0.4rem;
    padding: 0.4rem 0.5rem 0.2rem;
  }

  /* 建議提示詞：改成橫向捲動的氣泡列 */
  .suggested-prompts-wrapper {
    position: relative;
    flex: 0 0 auto;
  }
  .suggested-prompts {
    padding: 0.25rem 0.25rem 0.4rem;
    max-height: 72px;
    display: flex;
    flex-wrap: nowrap;
    gap: 0.5rem;
    overflow-x: auto;
    overflow-y: hidden;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none; /* Firefox */
  }
  .suggested-prompts::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
  }
  .suggested-prompts button {
    font-size: 0.8rem;
    padding: 0.3rem 0.6rem;
    white-space: nowrap;
    flex: 0 0 auto;
    z-index: 1;
  }

  /* 取代舊的偽元素箭頭與陰影（已移除） */
  /* .suggested-prompts-wrapper.has-scroll::after,
     .suggested-prompts-wrapper.has-scroll::before { ... } */

  /* 新：左右可點擊箭頭指示 */
  .scroll-indicator {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 32px;
    margin: auto 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    color: #fff;
    background: rgba(0,0,0,0.85);
    border-radius: 999px;
    box-shadow: 
      0 6px 18px rgba(0,0,0,0.35),
      0 0 20px rgba(0,0,0,0.4),
      0 0 40px rgba(0,0,0,0.25);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.25s ease, transform 0.12s ease, box-shadow 0.25s ease;
    z-index: 3;
    user-select: none;
  }
  .scroll-indicator::before {
    content: "";
    position: absolute;
    inset: -12px;
    background: radial-gradient(circle, rgba(0,0,0,0.6) 0%, transparent 70%);
    border-radius: 999px;
    z-index: -1;
    filter: blur(8px);
  }
  .scroll-indicator.left {
    left: 6px;
  }
  .scroll-indicator.right {
    right: 6px;
  }
  .scroll-indicator.show {
    opacity: 1;
    pointer-events: auto;
  }
  .scroll-indicator:active {
    transform: scale(0.96);
    box-shadow: 
      0 4px 12px rgba(0,0,0,0.4),
      0 0 15px rgba(0,0,0,0.5),
      0 0 30px rgba(0,0,0,0.3);
  }

  body.modal-open .scroll-indicator {
    display: none !important;
  }

  /* 聊天區：唯一可以垂直捲動的地方 */
  .chat-area {
    flex: 1 1 0;
    min-height: 0;               /* 讓 flex 正確分配高度 */
    overflow-y: auto;
    padding: 0.6rem;
    background: rgba(248,249,250,0.6);
    backdrop-filter: blur(8px);
  }

  /* 輸入區：固定在底部，不跟 chat-area 搶高度 */
  .input-group {
    flex: 0 0 auto;
    padding: 0;
    margin: 0.4rem 0.25rem;
    margin-bottom: calc(env(safe-area-inset-bottom, 0.5rem) + 0.6rem);
    border-radius:24px;
  }

  .input-group .form-control {
    font-size: 0.9rem;
    padding: 0.55rem 0.7rem;
  }

  .input-group .btn {
    padding: 0.55rem 0.75rem;
    font-size: 0.9rem;
  }
}

/* 桌機版保險層:強制隱藏手機版元素 */
@media (min-width: 769px) {
  .mobile-top-bar {
    display: none !important;
  }
}







  
  /* ==============================
     深色模式覆蓋（prefers-color-scheme: dark）
     ============================== */
  @media (prefers-color-scheme: dark) {
    body {
      background:linear-gradient(135deg,#364a8a,#402e6b);
      color:#ececec;
    }
    .card {
      background-color:rgba(30,30,30,0.65);
      box-shadow:0 10px 30px rgba(0,0,0,0.7);
    }
    .card-header {
      background:linear-gradient(135deg,#1e3a8a,#0d47a1);
      color:#f0f0f0;
    }
    .card-body { color:#ddd; }
  
    .qa-type-selector {
      background:#3a3a3a;
    }
    .qa-type-selector .form-check-label { color:#ddd; }
  
    .input-group {
      background:rgba(12,14,24,0.92);
      border:1px solid rgba(255,255,255,0.08);
      box-shadow:0 18px 40px rgba(0,0,0,0.75);
    }
    .input-group:focus-within {
      border-color:rgba(102,126,234,0.6);
      box-shadow:0 24px 55px rgba(0,0,0,0.85);
    }
    .input-group .form-control {
      background:#2b2b2b;border-color:#555;color:#eee;
    }
    .input-group .form-control:focus {
      border-color:#0d47a1;
      box-shadow:0 0 0 0.25rem rgba(13,71,161,0.4);
    }
  
    .input-group .btn {
      background:#0d47a1;border-color:#0d47a1;color:#fff;
    }
    .input-group .btn:hover {
      background:#0b3a8c;border-color:#0b3a8c;
      box-shadow:0 6px 20px rgba(0,0,0,0.7);
    }

    .generation-params .btn-secondary {
      background:linear-gradient(135deg,#343d94,#5c2d95);
      box-shadow:0 18px 40px rgba(0,0,0,0.55);
    }
    .generation-params .btn-secondary:hover {
      box-shadow:0 24px 48px rgba(0,0,0,0.65);
    }

    #startVerifyBtn {
      background:linear-gradient(135deg,#ff9f43,#f368e0);
      box-shadow:0 18px 42px rgba(0,0,0,0.6);
    }
    #startVerifyBtn::before {
      background:#ffe0c2;
      box-shadow:0 0 12px rgba(255,224,194,0.85);
    }
    #startVerifyBtn:hover {
      box-shadow:0 24px 52px rgba(0,0,0,0.7);
    }

    #sendButton {
      background:linear-gradient(135deg,#3b82f6,#1e40af);
      box-shadow:0 16px 36px rgba(0,0,0,0.6);
      color:#fff;
    }
    #sendButton:hover:not(:disabled) {
      box-shadow:0 22px 48px rgba(0,0,0,0.7);
    }
    #sendButton:focus-visible {
      box-shadow:0 0 0 3px rgba(59,130,246,0.5);
    }
    #sendButton:disabled {
      background:linear-gradient(135deg,#4c4c4c,#2f2f2f);
      color:#bbb;
      box-shadow:none;
    }

    .mobile-top-bar .dropdown-toggle,
    .mobile-top-bar .mobile-style-btn {
      background:linear-gradient(135deg,#1b1d3a,#3d2c6f);
      box-shadow:0 14px 32px rgba(0,0,0,0.55);
    }
    .mobile-top-bar .dropdown-menu {
      background:rgba(18,20,35,0.92);
      box-shadow:0 18px 40px rgba(0,0,0,0.65);
    }
    .mobile-top-bar .dropdown-item {
      color:#e5e7ff;
    }
    .mobile-top-bar .dropdown-item:hover,
    .mobile-top-bar .dropdown-item:focus {
      color:#fff;
      background:linear-gradient(135deg,rgba(103,126,234,0.4),rgba(129,140,248,0.4));
      box-shadow:inset 0 0 0 1px rgba(255,255,255,0.08);
    }
  
    /* 深色下建議提示詞 Hover */
    .suggested-prompts button:hover {
      transform:scale(1.08);
      box-shadow:0 8px 24px rgba(255,255,255,0.2);
    }


    
   body::before {
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  opacity: 0.2;
  background: radial-gradient(circle, #263238, #4b3869, #6c3a5e, #000000);
  background-size: 300% 300%;
  animation: bgFlowDark 30s ease-in-out infinite;
  transition: all 0.6s ease;
}

body.thinking::before {
  opacity: 0.95;
  filter: blur(60px) brightness(1.4);
  animation: bgFlowDarkThinking 3s ease-in-out infinite;
}

@keyframes bgFlowDark {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

@keyframes bgFlowDarkThinking {
  0% { background-position: 0% 0%; }
  25% { background-position: 50% 100%; }
  50% { background-position: 100% 50%; }
  75% { background-position: 50% 0%; }
  100% { background-position: 0% 0%; }
}


  
    .chat-area {
      background:rgba(20,20,20,0.6);
    }
    .chat-area::-webkit-scrollbar-track { background:#2b2b2b; }
    .chat-area::-webkit-scrollbar-thumb { background:#555; }
    .chat-area::-webkit-scrollbar-thumb:hover { background:#666; }
  
    .message {
      border-color:rgba(255,255,255,0.08);
      box-shadow:
        0 12px 30px rgba(0,0,0,0.55),
        0 3px 8px rgba(0,0,0,0.35);
    }
    .message:hover {
      box-shadow:
        0 20px 42px rgba(0,0,0,0.65),
        0 6px 16px rgba(0,0,0,0.4);
    }
    .message.user-message {
      background:#0d47a1;color:#fff;
      border-color:rgba(255,255,255,0.18);
    }
    .message.bot-message {
      background:#2c3e50;color:#ddd;border-color:#444;
    }
  
    footer a.text-muted { color:#fff !important; }
  
    /* reCAPTCHA Modal 深色優化 */
    #recaptchaModal .modal-content {
      background:#1e1e1e;color:#e0e0e0;border:none;
      box-shadow:
        inset 0 0 10px rgba(0,0,0,0.5),
        0 8px 24px rgba(0,0,0,0.8);
    }
    #recaptchaModal .modal-header { border-bottom:1px solid #333; }
    #recaptchaModal .modal-body { background:#2b2b2b; }
    #recaptchaModal .btn-close { display:none; }
    #recaptcha-container .grecaptcha-badge,
    #recaptcha-container iframe {
      filter:brightness(0.9) contrast(1.1);
    }

    /* 進階設定 Modal 深色優化 */
    #paramsModal .btn {
      border-radius:999px;
      border:none;
      font-weight:600;
      padding:0.6rem 1.25rem;
      box-shadow:0 14px 32px rgba(0,0,0,0.55);
    }
    #paramsModal .btn:focus-visible {
      box-shadow:0 0 0 3px rgba(13,71,161,0.45);
    }

    #paramsModal .btn-outline-success,
    #paramsModal .btn-success {
      background:linear-gradient(135deg,#0f9d58,#0b8043);
      color:#fff;
      box-shadow:0 18px 38px rgba(0,0,0,0.55);
    }
    #paramsModal .btn-outline-success:hover,
    #paramsModal .btn-success:hover {
      filter:brightness(1.03);
      box-shadow:0 22px 46px rgba(0,0,0,0.65);
    }

    #paramsModal .btn-outline-primary {
      background:linear-gradient(135deg,#1e3a8a,#0d47a1);
      color:#fff;
    }
    #paramsModal .btn-outline-primary:hover {
      filter:brightness(1.05);
      box-shadow:0 22px 46px rgba(0,0,0,0.7);
    }

    #paramsModal .btn-outline-warning {
      background:linear-gradient(135deg,#b85b16,#d97706);
      color:#fff;
    }
    #paramsModal .btn-outline-warning:hover {
      filter:brightness(1.05);
      box-shadow:0 22px 46px rgba(0,0,0,0.7);
    }

    #paramsModal .btn-outline-secondary {
      background:linear-gradient(135deg,#4a5568,#2d3748);
      color:#e5e7ff;
    }
    #paramsModal .btn-outline-secondary:hover {
      filter:brightness(1.04);
      box-shadow:0 22px 46px rgba(0,0,0,0.65);
    }

    #paramsModal .btn-group.w-100 {
      gap:0.6rem;
    }
    #paramsModal .btn-group.w-100 .btn {
      border-radius:16px;
      box-shadow:0 16px 32px rgba(0,0,0,0.65);
    }
    #paramsModal .btn-group.w-100 .btn small {
      color:rgba(255,255,255,0.9);
    }

    #paramsModal .modal-dialog {
      display: flex;
      align-items: center;
      min-height: calc(100% - 1rem);
    }
    #paramsModal .modal-content {
      background:#1e1e1e !important;color:#e0e0e0 !important;border:none;
      box-shadow: 0 8px 24px rgba(0,0,0,0.8);
    }
    #paramsModal .modal-header { 
      border-bottom:1px solid #333;
      background:linear-gradient(135deg,#5a5a5a,#d8d5d5);
      color:#fff !important;
    }
    #paramsModal .modal-body { 
      background:#2b2b2b !important;
      color:#e0e0e0 !important;
    }
    #paramsModal .modal-footer { 
      border-top:1px solid #333;
      background:#2b2b2b !important;
    }

    /* Modal 內所有文字顏色 */
    #paramsModal .modal-body * {
      color:#e0e0e0 !important;
    }
    #paramsModal .form-label {
      color:#e0e0e0 !important;
    }
    #paramsModal .form-text {
      color:#b0b0b0 !important;
    }
    #paramsModal .form-text small {
      color:#a0a0a0 !important;
    }

    /* 滑桿樣式改進 - 深色模式 */
    #paramsModal .form-range {
      background:transparent !important;
      height:8px;
    }
    #paramsModal .form-range::-webkit-slider-track {
      background:#555 !important;
      border-radius:5px;
      height:8px;
    }
    #paramsModal .form-range::-webkit-slider-thumb {
      background:#0d47a1 !important;
      border:2px solid #fff;
      border-radius:50%;
      height:20px;
      width:20px;
      cursor:pointer;
      -webkit-appearance:none;
      box-shadow:0 2px 6px rgba(0,0,0,0.3);
    }
    #paramsModal .form-range::-webkit-slider-thumb:hover {
      background:#1565c0 !important;
      box-shadow:0 4px 12px rgba(13,71,161,0.4);
    }
    #paramsModal .form-range::-moz-range-track {
      background:#555 !important;
      border-radius:5px;
      height:8px;
      border:none;
    }
    #paramsModal .form-range::-moz-range-thumb {
      background:#0d47a1 !important;
      border:2px solid #fff;
      border-radius:50%;
      height:20px;
      width:20px;
      cursor:pointer;
      box-shadow:0 2px 6px rgba(0,0,0,0.3);
    }

    /* 卡片樣式 - 深色模式 */
    #paramsModal .card {
      background:#333 !important;border-color:#444;
    }
    #paramsModal .card-header {
      background:#444 !important;border-bottom-color:#555;
      color:#e0e0e0 !important;
    }
    #paramsModal .card-body {
      background:#333 !important;
      color:#e0e0e0 !important;
    }

    /* Badge 樣式 - 深色模式 */
    #paramsModal .badge.bg-info {
      background:#17a2b8 !important;
      color:#fff !important;
    }
    #paramsModal .badge.bg-success {
      background:#28a745 !important;
      color:#fff !important;
    }

    /* 圖示顏色 */
    #paramsModal .text-danger {
      color:#ff6b6b !important;
    }
    #paramsModal .text-primary {
      color:#74b9ff !important;
    }
    
  }
